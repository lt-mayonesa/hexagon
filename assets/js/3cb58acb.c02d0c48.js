"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[920],{3650:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"advanced/custom-tools","title":"Custom Tools","description":"Hexagon allows you to create custom tools with Python code. This guide explains how to create and use custom tools in your CLI.","source":"@site/docs/advanced/custom-tools.md","sourceDirName":"advanced","slug":"/advanced/custom-tools","permalink":"/hexagon/docs/advanced/custom-tools","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/advanced/custom-tools.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Troubleshooting","permalink":"/hexagon/docs/guides/troubleshooting"},"next":{"title":"Prompting System","permalink":"/hexagon/docs/advanced/prompting"}}');var s=r(4848),t=r(8453);const i={sidebar_position:1},l="Custom Tools",a={},c=[{value:"Understanding Custom Tools",id:"understanding-custom-tools",level:2},{value:"Creating a Custom Tool",id:"creating-a-custom-tool",level:2},{value:"Step 1: Set Up Your Custom Tools Directory",id:"step-1-set-up-your-custom-tools-directory",level:3},{value:"Step 2: Create a Python Module",id:"step-2-create-a-python-module",level:3},{value:"YAML Configuration",id:"yaml-configuration",level:3},{value:"Understanding the main() Function",id:"understanding-the-main-function",level:3},{value:"Parameters:",id:"parameters",level:4},{value:"Return Value:",id:"return-value",level:4},{value:"Accessing Argument Values",id:"accessing-argument-values",level:3},{value:"Using the Printer Module",id:"using-the-printer-module",level:3},{value:"Example: Data Processing Tool",id:"example-data-processing-tool",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Code Organization",id:"code-organization",level:3},{value:"User Experience",id:"user-experience",level:3},{value:"Performance",id:"performance",level:3},{value:"Security",id:"security",level:3},{value:"Examples from Hexagon Core",id:"examples-from-hexagon-core",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"custom-tools",children:"Custom Tools"})}),"\n",(0,s.jsx)(n.p,{children:"Hexagon allows you to create custom tools with Python code. This guide explains how to create and use custom tools in your CLI."}),"\n",(0,s.jsx)(n.p,{children:"Custom tools are a core feature of Hexagon, allowing you to implement complex functionality that goes beyond simple shell commands or web links. They are Python modules that can be referenced directly in your CLI configuration."}),"\n",(0,s.jsx)(n.h2,{id:"understanding-custom-tools",children:"Understanding Custom Tools"}),"\n",(0,s.jsx)(n.p,{children:"Custom tools are Python modules that integrate with Hexagon's core functionality. They allow you to implement complex logic, interactive prompts, and rich terminal output that goes beyond simple shell commands or web links."}),"\n",(0,s.jsx)(n.p,{children:"All custom Python tools follow a standard pattern:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Define an ",(0,s.jsx)(n.code,{children:"Args"})," class for command-line arguments (optional)"]}),"\n",(0,s.jsxs)(n.li,{children:["Implement a ",(0,s.jsx)(n.code,{children:"main(tool, env, env_args, cli_args)"})," function"]}),"\n",(0,s.jsx)(n.li,{children:"Reference the module in your CLI configuration"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"creating-a-custom-tool",children:"Creating a Custom Tool"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-set-up-your-custom-tools-directory",children:"Step 1: Set Up Your Custom Tools Directory"}),"\n",(0,s.jsxs)(n.p,{children:["Specify a ",(0,s.jsx)(n.code,{children:"custom_tools_dir"})," in your CLI configuration:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"cli:\n  name: My CLI\n  command: mycli\n  custom_tools_dir: ./custom_tools  # relative to the config file\n"})}),"\n",(0,s.jsx)(n.p,{children:"This directory will be added to Python's import path, allowing Hexagon to find your modules."}),"\n",(0,s.jsx)(n.h3,{id:"step-2-create-a-python-module",children:"Step 2: Create a Python Module"}),"\n",(0,s.jsx)(n.p,{children:"Create a Python module with the standard tool structure:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# custom_tools/greeting_tool.py\nfrom hexagon.support.output.printer import log\nfrom hexagon.support.input.args import ToolArgs, PositionalArg, OptionalArg, Arg\n\nclass Args(ToolArgs):\n    """Define command-line arguments for this tool."""\n    name: PositionalArg[str] = Arg(\n        None,\n        prompt_message="Enter your name",\n        description="The name to greet"\n    )\n    greeting: OptionalArg[str] = Arg(\n        "Hello",\n        alias="g",\n        prompt_message="Enter a greeting",\n        description="The greeting to use"\n    )\n\ndef main(tool, env, env_args, cli_args: Args):\n    """Main entry point for the tool.\n\n    Args:\n        tool: The ActionTool object from YAML configuration\n        env: The selected Environment object (or None)\n        env_args: Environment-specific arguments from tool.envs[env.name]\n        cli_args: Parsed command-line arguments (Args instance)\n    """\n    # Prompt for name if not provided via command line\n    if not cli_args.name.value:\n        cli_args.name.prompt()\n\n    # Access environment information\n    env_name = env.name if env else "No environment"\n    env_specific = env_args if env_args else {}\n\n    # Log information messages\n    log.info(f"Tool: {tool.name}")\n    log.info(f"Environment: {env_name}")\n\n    # Create the greeting message\n    message = f"{cli_args.greeting.value}, {cli_args.name.value}!"\n\n    # Return results (displayed with log.result())\n    return [message, f"Environment args: {env_specific}"]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"yaml-configuration",children:"YAML Configuration"}),"\n",(0,s.jsx)(n.p,{children:"To use this custom tool in your CLI, configure it as a shell tool that references the Python module:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"- name: greet\n  alias: g\n  long_name: Greeting\n  description: Greet a person\n  type: shell\n  action: greeting_tool\n"})}),"\n",(0,s.jsx)(n.p,{children:"You can also provide environment-specific parameters:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'- name: greet-env\n  alias: ge\n  long_name: Environment Greeting\n  description: Greet a person with environment-specific settings\n  type: shell\n  action: greeting_tool\n  envs:\n    dev:\n      language: "English"\n      formal: false\n    prod:\n      language: "Spanish"\n      formal: true\n'})}),"\n",(0,s.jsx)(n.h3,{id:"understanding-the-main-function",children:"Understanding the main() Function"}),"\n",(0,s.jsxs)(n.p,{children:["Every custom tool must implement a ",(0,s.jsx)(n.code,{children:"main()"})," function with this exact signature:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"def main(tool, env, env_args, cli_args):\n    pass\n"})}),"\n",(0,s.jsx)(n.h4,{id:"parameters",children:"Parameters:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"tool"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ActionTool"})}),(0,s.jsx)(n.td,{children:"The tool configuration object from YAML (name, alias, description, action, etc.)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"env"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"Env"})," or ",(0,s.jsx)(n.code,{children:"None"})]}),(0,s.jsx)(n.td,{children:'The selected environment object (None if no environment or wildcard "*")'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"env_args"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Any"})}),(0,s.jsxs)(n.td,{children:["Environment-specific value from ",(0,s.jsx)(n.code,{children:"tool.envs[env.name]"})," (can be string, list, dict, or any type)"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"cli_args"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"Args"})," or ",(0,s.jsx)(n.code,{children:"CliArgs"})]}),(0,s.jsxs)(n.td,{children:["Parsed command-line arguments. If you define an ",(0,s.jsx)(n.code,{children:"Args"})," class, it will be this type; otherwise, a generic ",(0,s.jsx)(n.code,{children:"CliArgs"})," object"]})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"return-value",children:"Return Value:"}),"\n",(0,s.jsx)(n.p,{children:"Custom tools should return:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"List of strings"}),": Each string is displayed as a result line"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"None"}),": No explicit output (tool should use ",(0,s.jsx)(n.code,{children:"log.info()"}),", ",(0,s.jsx)(n.code,{children:"log.result()"}),", etc. directly)"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'def main(tool, env, env_args, cli_args):\n    # Return explicit results\n    return [\n        "Operation successful",\n        "Processed 10 items",\n        "Duration: 2.5s"\n    ]\n\n# Or use logging directly\ndef main(tool, env, env_args, cli_args):\n    log.result("Operation successful")\n    log.info(f"Processed {count} items")\n    # No return value\n'})}),"\n",(0,s.jsx)(n.h3,{id:"accessing-argument-values",children:"Accessing Argument Values"}),"\n",(0,s.jsxs)(n.p,{children:["When working with the ",(0,s.jsx)(n.code,{children:"Args"})," class, you have two ways to access values:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# Option 1: .value property (explicit)\nname = cli_args.name.value  # Returns the actual value\n\n# Option 2: Direct access (for checking)\nif cli_args.name:  # Checks if value exists (not None)\n    name = cli_args.name.value\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Best Practice"}),": Always use ",(0,s.jsx)(n.code,{children:".value"})," to get the actual value. The argument object itself contains metadata and prompt methods."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# Good\nname = cli_args.name.value\nlog.info(f"Hello, {name}!")\n\n# Not recommended - accessing the argument object itself\nlog.info(f"Hello, {cli_args.name}!")  # May not display correctly\n'})}),"\n",(0,s.jsx)(n.h3,{id:"using-the-printer-module",children:"Using the Printer Module"}),"\n",(0,s.jsxs)(n.p,{children:["Custom tools can use the ",(0,s.jsx)(n.code,{children:"log"})," object from ",(0,s.jsx)(n.code,{children:"hexagon.support.output.printer"})," to display information:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from hexagon.support.output.printer import log\n\ndef main(tool, env, env_args, cli_args):\n    # Display information messages\n    log.info("Processing...")\n    \n    # Display a panel with highlighted information\n    log.panel("Important information", title="Note")\n    \n    # Display example code\n    log.example("print(\'Hello, World!\')", syntax="python")\n    \n    # Return results\n    return ["Operation completed successfully"]\n'})}),"\n",(0,s.jsx)(n.h2,{id:"example-data-processing-tool",children:"Example: Data Processing Tool"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# custom_tools/data_processor.py\nimport json\nimport os\nfrom hexagon.support.output.printer import log\nfrom hexagon.support.input.args import ToolArgs, PositionalArg, Arg\n\nclass Args(ToolArgs):\n    file_path: PositionalArg[str] = Arg(\n        None, prompt_message="Enter the path to the JSON file"\n    )\n\ndef main(tool, env, env_args, cli_args):\n    # Only prompt if the file path wasn\'t provided as a command-line argument\n    if not cli_args.file_path.value:\n        cli_args.file_path.prompt()\n    \n    log.info(f"Processing file: {cli_args.file_path.value}")\n    \n    if not os.path.exists(cli_args.file_path.value):\n        log.error(f"File not found: {cli_args.file_path.value}")\n        return [f"Error: File not found: {cli_args.file_path.value}"]\n    \n    try:\n        with open(cli_args.file_path.value, \'r\') as f:\n            data = json.load(f)\n        \n        # Process the data\n        item_count = len(data)\n        categories = set(item[\'category\'] for item in data if \'category\' in item)\n        \n        log.info(f"Found {item_count} items")\n        log.info(f"Found {len(categories)} categories")\n        \n        return [\n            f"Processed {item_count} items",\n            f"Found {len(categories)} categories: {\', \'.join(categories)}"\n        ]\n    except json.JSONDecodeError:\n        log.error("Invalid JSON file")\n        return ["Error: Invalid JSON file"]\n    except Exception as e:\n        log.error(f"Error: {str(e)}")\n        return [f"Error: {str(e)}"]\n'})}),"\n",(0,s.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsx)(n.p,{children:"Always handle errors gracefully in your custom tools:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from hexagon.domain.hexagon_error import HexagonError\n\ndef main(tool, env, env_args, cli_args):\n    try:\n        # Your tool logic\n        result = perform_operation()\n        return [f"Success: {result}"]\n\n    except FileNotFoundError as e:\n        # User-friendly error messages\n        log.error(f"File not found: {e.filename}")\n        return [f"Error: File \'{e.filename}\' does not exist"]\n\n    except ValueError as e:\n        # Specific error handling\n        log.error(f"Invalid value: {str(e)}")\n        raise HexagonError(f"Invalid input: {str(e)}")\n\n    except Exception as e:\n        # Catch-all for unexpected errors\n        log.error(f"Unexpected error: {str(e)}")\n        raise HexagonError(f"Operation failed: {str(e)}")\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Error Handling Strategies:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Return error message"}),": Tool completes but shows error in output"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Raise HexagonError"}),": Stops execution and displays error to user"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Log and continue"}),": Use ",(0,s.jsx)(n.code,{children:"log.error()"})," for warnings that don't stop execution"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"code-organization",children:"Code Organization"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"One tool per file"}),": Keep tools focused and maintainable"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Descriptive names"}),": Use clear module and function names"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Documentation"}),": Add docstrings to Args class and main() function"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Type hints"}),": Use type annotations for better IDE support"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"user-experience",children:"User Experience"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Clear prompts"}),": Use descriptive ",(0,s.jsx)(n.code,{children:"prompt_message"})," for arguments"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Helpful descriptions"}),": Add ",(0,s.jsx)(n.code,{children:"description"})," to all arguments"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Progress feedback"}),": Use ",(0,s.jsx)(n.code,{children:"log.info()"})," for long-running operations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Consistent output"}),": Return structured, readable results"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"performance",children:"Performance"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Lazy loading"}),": Import heavy dependencies inside main() if not always needed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Caching"}),": Use ",(0,s.jsx)(n.code,{children:"hexagon.support.storage"})," to cache expensive operations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Background operations"}),": Consider using hooks with ",(0,s.jsx)(n.code,{children:"HookSubscrptionType.background"})," for async work"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"security",children:"Security"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Validate input"}),": Always validate user input before using it"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Sensitive data"}),": Use ",(0,s.jsx)(n.code,{children:"skip_trace=True"})," when prompting for passwords"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"File paths"}),": Validate and sanitize file paths before file operations"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# Example: Secure password handling\nclass Args(ToolArgs):\n    password: PositionalArg[str] = Arg(None)\n\ndef main(tool, env, env_args, cli_args):\n    # Prompt without tracing sensitive data\n    if not cli_args.password.value:\n        cli_args.password.prompt(skip_trace=True)\n\n    # Use the password (it won't appear in replay)\n    authenticate(cli_args.password.value)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"examples-from-hexagon-core",children:"Examples from Hexagon Core"}),"\n",(0,s.jsxs)(n.p,{children:["Hexagon includes several built-in custom tools in the ",(0,s.jsx)(n.code,{children:"hexagon/actions"})," directory that demonstrate best practices:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"hexagon/actions/external/open_link.py"})}),": Opens URLs in the default browser"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"hexagon/actions/internal/create_new_tool.py"})}),": Creates new tools with interactive prompts"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"hexagon/actions/internal/install_cli.py"})}),": Installs a CLI with proper error handling"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"hexagon/actions/internal/save_new_alias.py"})}),": Saves command aliases with storage API"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"hexagon/actions/internal/replay.py"})}),": Replays last command using tracer"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"These tools show how to implement complex functionality, handle errors, and provide excellent user experience."}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Learn about ",(0,s.jsx)(n.a,{href:"prompting",children:"Prompting"})," for advanced interactive features"]}),"\n",(0,s.jsxs)(n.li,{children:["Explore ",(0,s.jsx)(n.a,{href:"hooks",children:"Hooks"})," to extend your CLI's functionality"]}),"\n",(0,s.jsxs)(n.li,{children:["Check the ",(0,s.jsx)(n.a,{href:"../api/support/output",children:"Output API"})," for rich terminal output"]}),"\n",(0,s.jsxs)(n.li,{children:["See ",(0,s.jsx)(n.a,{href:"../api/support/storage",children:"Storage API"})," for persisting data"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var o=r(6540);const s={},t=o.createContext(s);function i(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);