"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[9550],{2304(e,o,n){n.r(o),n.d(o,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"api/support/hooks","title":"Hooks API","description":"Hexagon provides a hooks system that allows you to execute code at specific points in the CLI lifecycle. This page documents the hooks API and how to use it in your custom tools and plugins.","source":"@site/docs/api/support/hooks.md","sourceDirName":"api/support","slug":"/api/support/hooks","permalink":"/hexagon/docs/api/support/hooks","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/api/support/hooks.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"apiSidebar","previous":{"title":"Output API","permalink":"/hexagon/docs/api/support/output"},"next":{"title":"Storage API","permalink":"/hexagon/docs/api/support/storage"}}');var t=n(4848),i=n(8453);const r={sidebar_position:2},a="Hooks API",c={},l=[{value:"HexagonHooks Class",id:"hexagonhooks-class",level:2},{value:"Available Hooks",id:"available-hooks",level:2},{value:"Hook Subscription",id:"hook-subscription",level:2},{value:"HookSubscrptionType",id:"hooksubscrptiontype",level:3},{value:"Hook Data Types",id:"hook-data-types",level:2},{value:"Selection[T]",id:"selectiont",level:3},{value:"ToolExecutionParameters",id:"toolexecutionparameters",level:3},{value:"ToolExecutionData",id:"toolexecutiondata",level:3},{value:"Hook Registration in Plugins",id:"hook-registration-in-plugins",level:2},{value:"Examples",id:"examples",level:2},{value:"Logging Hook",id:"logging-hook",level:3},{value:"Authentication Hook",id:"authentication-hook",level:3},{value:"Tool Usage Tracking",id:"tool-usage-tracking",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"See Also",id:"see-also",level:2}];function d(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.header,{children:(0,t.jsx)(o.h1,{id:"hooks-api",children:"Hooks API"})}),"\n",(0,t.jsx)(o.p,{children:"Hexagon provides a hooks system that allows you to execute code at specific points in the CLI lifecycle. This page documents the hooks API and how to use it in your custom tools and plugins."}),"\n",(0,t.jsx)(o.h2,{id:"hexagonhooks-class",children:"HexagonHooks Class"}),"\n",(0,t.jsxs)(o.p,{children:["The ",(0,t.jsx)(o.code,{children:"HexagonHooks"})," class is defined in ",(0,t.jsx)(o.code,{children:"hexagon/support/hooks/__init__.py"})," and provides access to the available hooks:"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:'from hexagon.support.hooks import HexagonHooks\nfrom hexagon.support.hooks.hook import HookSubscription\n\n# Subscribe to the start hook\nHexagonHooks.start.subscribe(\n    HookSubscription("my-start-hook", callback=my_start_function)\n)\n\n# Subscribe to the end hook\nHexagonHooks.end.subscribe(\n    HookSubscription("my-end-hook", callback=my_end_function)\n)\n'})}),"\n",(0,t.jsx)(o.h2,{id:"available-hooks",children:"Available Hooks"}),"\n",(0,t.jsx)(o.p,{children:"Hexagon provides six lifecycle hooks:"}),"\n",(0,t.jsxs)(o.table,{children:[(0,t.jsx)(o.thead,{children:(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.th,{children:"Hook"}),(0,t.jsx)(o.th,{children:"Description"}),(0,t.jsx)(o.th,{children:"When It's Called"}),(0,t.jsx)(o.th,{children:"Data Type"})]})}),(0,t.jsxs)(o.tbody,{children:[(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"start"})}),(0,t.jsx)(o.td,{children:"Called when Hexagon starts"}),(0,t.jsx)(o.td,{children:"At the beginning of execution"}),(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"None"})})]}),(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"tool_selected"})}),(0,t.jsx)(o.td,{children:"Called when a tool is selected"}),(0,t.jsx)(o.td,{children:"After tool selection"}),(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"Selection[Tool]"})})]}),(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"env_selected"})}),(0,t.jsx)(o.td,{children:"Called when an environment is selected"}),(0,t.jsx)(o.td,{children:"After environment selection"}),(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"Selection[Env]"})})]}),(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"before_tool_executed"})}),(0,t.jsx)(o.td,{children:"Called before a tool is executed"}),(0,t.jsx)(o.td,{children:"Before tool execution"}),(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"ToolExecutionParameters"})})]}),(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"tool_executed"})}),(0,t.jsx)(o.td,{children:"Called after a tool is executed"}),(0,t.jsx)(o.td,{children:"After tool execution completes"}),(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"ToolExecutionData"})})]}),(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"end"})}),(0,t.jsx)(o.td,{children:"Called when Hexagon ends"}),(0,t.jsx)(o.td,{children:"At the end of execution"}),(0,t.jsx)(o.td,{children:(0,t.jsx)(o.code,{children:"None"})})]})]})]}),"\n",(0,t.jsx)(o.h2,{id:"hook-subscription",children:"Hook Subscription"}),"\n",(0,t.jsxs)(o.p,{children:["To subscribe to a hook, use the ",(0,t.jsx)(o.code,{children:"HookSubscription"})," class:"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:'from hexagon.support.hooks import HexagonHooks\nfrom hexagon.support.hooks.hook import HookSubscription, HookSubscrptionType\n\ndef my_callback(data=None):\n    """Hook callback function.\n\n    Args:\n        data: Hook-specific data (None for start/end hooks)\n    """\n    print(f"Hook called with data: {data}")\n\n# Create a subscription\nsubscription = HookSubscription(\n    "unique-hook-id",                    # Unique identifier for this subscription\n    callback=my_callback,                # Function to call\n    type=HookSubscrptionType.sync        # Optional: sync (default) or background\n)\n\n# Subscribe to a hook\nHexagonHooks.start.subscribe(subscription)\n'})}),"\n",(0,t.jsx)(o.h3,{id:"hooksubscrptiontype",children:"HookSubscrptionType"}),"\n",(0,t.jsx)(o.p,{children:"Hooks can run in two modes:"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:(0,t.jsx)(o.code,{children:"HookSubscrptionType.sync"})})," (default): Hook runs synchronously, blocking execution"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:(0,t.jsx)(o.code,{children:"HookSubscrptionType.background"})}),": Hook runs in a background thread"]}),"\n"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:'from hexagon.support.hooks.hook import HookSubscription, HookSubscrptionType\n\n# Background hook (non-blocking)\nHexagonHooks.tool_executed.subscribe(\n    HookSubscription(\n        "telemetry-reporter",\n        callback=send_telemetry,\n        type=HookSubscrptionType.background\n    )\n)\n'})}),"\n",(0,t.jsx)(o.h2,{id:"hook-data-types",children:"Hook Data Types"}),"\n",(0,t.jsx)(o.h3,{id:"selectiont",children:"Selection[T]"}),"\n",(0,t.jsxs)(o.p,{children:["Used by ",(0,t.jsx)(o.code,{children:"tool_selected"})," and ",(0,t.jsx)(o.code,{children:"env_selected"})," hooks:"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:'from hexagon.domain.hooks.wax import Selection, SelectionType\n\ndef on_tool_selected(selection: Selection):\n    print(f"Tool selected: {selection.value.name}")\n    print(f"Selection type: {selection.selection_type}")  # prompt or args\n\nHexagonHooks.tool_selected.subscribe(\n    HookSubscription("tool-logger", callback=on_tool_selected)\n)\n'})}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.strong,{children:"Properties:"})}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"value"}),": The selected tool or environment object"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"selection_type"}),": How it was selected (",(0,t.jsx)(o.code,{children:"SelectionType.prompt"})," or ",(0,t.jsx)(o.code,{children:"SelectionType.args"}),")"]}),"\n"]}),"\n",(0,t.jsx)(o.h3,{id:"toolexecutionparameters",children:"ToolExecutionParameters"}),"\n",(0,t.jsxs)(o.p,{children:["Used by ",(0,t.jsx)(o.code,{children:"before_tool_executed"})," hook:"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:'def on_before_execution(params):\n    print(f"Executing tool: {params.tool.name}")\n    print(f"Environment: {params.env.name if params.env else \'None\'}")\n    print(f"Environment args: {params.parameters}")\n    print(f"CLI arguments: {params.arguments}")\n\nHexagonHooks.before_tool_executed.subscribe(\n    HookSubscription("pre-exec-logger", callback=on_before_execution)\n)\n'})}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.strong,{children:"Properties:"})}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"tool"}),": The ",(0,t.jsx)(o.code,{children:"ActionTool"})," being executed"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"parameters"}),": Environment-specific parameters (",(0,t.jsx)(o.code,{children:"env_args"}),")"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"env"}),": The selected ",(0,t.jsx)(o.code,{children:"Env"})," object (or ",(0,t.jsx)(o.code,{children:"None"}),")"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"arguments"}),": Parsed CLI arguments"]}),"\n"]}),"\n",(0,t.jsx)(o.h3,{id:"toolexecutiondata",children:"ToolExecutionData"}),"\n",(0,t.jsxs)(o.p,{children:["Used by ",(0,t.jsx)(o.code,{children:"tool_executed"})," hook:"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:'def on_after_execution(data):\n    print(f"Tool executed: {data.tool.name}")\n    print(f"Duration: {data.duration:.2f}s")\n    print(f"Environment args: {data.tool_env_args}")\n\nHexagonHooks.tool_executed.subscribe(\n    HookSubscription("post-exec-logger", callback=on_after_execution)\n)\n'})}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.strong,{children:"Properties:"})}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"tool"}),": The ",(0,t.jsx)(o.code,{children:"ActionTool"})," that was executed"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"tool_env_args"}),": Environment-specific arguments used"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"duration"}),": Execution time in seconds"]}),"\n"]}),"\n",(0,t.jsx)(o.h2,{id:"hook-registration-in-plugins",children:"Hook Registration in Plugins"}),"\n",(0,t.jsxs)(o.p,{children:["Hooks are typically registered in a plugin's ",(0,t.jsx)(o.code,{children:"main"})," function:"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:'# my_plugin.py\nfrom hexagon.support.hooks import HexagonHooks\nfrom hexagon.support.hooks.hook import HookSubscription\n\ndef main():\n    """Plugin initialization function."""\n    HexagonHooks.start.subscribe(\n        HookSubscription("plugin-start", callback=on_start)\n    )\n    HexagonHooks.end.subscribe(\n        HookSubscription("plugin-end", callback=on_end)\n    )\n\ndef on_start():\n    print("Hexagon is starting...")\n\ndef on_end():\n    print("Hexagon is ending...")\n'})}),"\n",(0,t.jsx)(o.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(o.h3,{id:"logging-hook",children:"Logging Hook"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:'# logging_plugin.py\nimport logging\nimport time\nfrom hexagon.support.hooks import HexagonHooks\nfrom hexagon.support.hooks.hook import HookSubscription\n\nstart_time = None\n\ndef main():\n    # Configure logging\n    logging.basicConfig(filename="hexagon.log", level=logging.INFO)\n\n    # Register hooks\n    HexagonHooks.start.subscribe(\n        HookSubscription("log-start", callback=log_start)\n    )\n    HexagonHooks.tool_executed.subscribe(\n        HookSubscription("log-execution", callback=log_execution)\n    )\n    HexagonHooks.end.subscribe(\n        HookSubscription("log-end", callback=log_end)\n    )\n\ndef log_start():\n    global start_time\n    start_time = time.time()\n    logging.info(f"Hexagon started at {time.strftime(\'%Y-%m-%d %H:%M:%S\')}")\n\ndef log_execution(data):\n    logging.info(f"Executed tool: {data.tool.name} in {data.duration:.2f}s")\n\ndef log_end():\n    end_time = time.time()\n    duration = end_time - start_time\n    logging.info(f"Hexagon ended at {time.strftime(\'%Y-%m-%d %H:%M:%S\')}")\n    logging.info(f"Total duration: {duration:.2f} seconds")\n'})}),"\n",(0,t.jsx)(o.h3,{id:"authentication-hook",children:"Authentication Hook"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:'# auth_plugin.py\nfrom hexagon.support.hooks import HexagonHooks\nfrom hexagon.support.hooks.hook import HookSubscription\nfrom hexagon.domain.hexagon_error import HexagonError\n\ndef main():\n    HexagonHooks.start.subscribe(\n        HookSubscription("auth-check", callback=check_auth)\n    )\n\ndef check_auth():\n    # Check if the user is authenticated\n    if not is_authenticated():\n        # Prompt for authentication\n        if not authenticate():\n            # If authentication fails, raise an error to stop execution\n            raise HexagonError("Authentication failed")\n\ndef is_authenticated():\n    # Check if the user is authenticated\n    # This is just an example, implement your own authentication logic\n    return False\n\ndef authenticate():\n    # Implement your authentication logic\n    print("Please enter your credentials:")\n    username = input("Username: ")\n    password = input("Password: ")\n\n    # Validate credentials\n    # This is just an example, implement your own validation logic\n    return username == "admin" and password == "password"\n'})}),"\n",(0,t.jsx)(o.h3,{id:"tool-usage-tracking",children:"Tool Usage Tracking"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:'# usage_tracker.py\nfrom hexagon.support.hooks import HexagonHooks\nfrom hexagon.support.hooks.hook import HookSubscription, HookSubscrptionType\nfrom hexagon.support.storage import store_user_data, load_user_data\n\ndef main():\n    # Track tool usage in the background (non-blocking)\n    HexagonHooks.tool_executed.subscribe(\n        HookSubscription(\n            "usage-tracker",\n            callback=track_usage,\n            type=HookSubscrptionType.background\n        )\n    )\n\ndef track_usage(data):\n    """Track tool usage statistics."""\n    tool_name = data.tool.name\n\n    # Load existing stats\n    stats = load_user_data("usage_stats") or {}\n\n    # Update count\n    stats[tool_name] = stats.get(tool_name, 0) + 1\n\n    # Save updated stats\n    store_user_data("usage_stats", stats)\n\n    print(f"Tool \'{tool_name}\' has been used {stats[tool_name]} times")\n'})}),"\n",(0,t.jsx)(o.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Keep Hook Functions Simple"}),": Hook functions should be small and focused"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Handle Errors"}),": Handle errors in hook functions to avoid breaking the CLI"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Document Your Hooks"}),": Document what your hook functions do and when they're called"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Use Appropriate Hooks"}),": Choose the right hook for your use case"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Be Mindful of Performance"}),": Synchronous hooks block execution, use background hooks for non-critical tasks"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Unique Hook IDs"}),": Use descriptive, unique IDs for hook subscriptions to avoid conflicts"]}),"\n"]}),"\n",(0,t.jsx)(o.h2,{id:"see-also",children:"See Also"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.a,{href:"../../guides/plugins",children:"Plugins Guide"})," - Learn how to create plugins"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.a,{href:"storage",children:"Storage API"})," - Store and retrieve user data"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.a,{href:"https://github.com/lt-mayonesa/hexagon/tree/main/hexagon/domain/hooks",children:"Hooks Domain Types"})," - Full type definitions"]}),"\n"]})]})}function h(e={}){const{wrapper:o}={...(0,i.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,o,n){n.d(o,{R:()=>r,x:()=>a});var s=n(6540);const t={},i=s.createContext(t);function r(e){const o=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(i.Provider,{value:o},e.children)}}}]);